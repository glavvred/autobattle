using System;
using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using SimpleJSON;

public class InputParser
{
    string jsonStr;
    private Side _side;

    public InputParser(GameObject caller)
    {
        _side = caller.gameObject.GetComponent<Side>();
    }

    public void JsonParse()
    {
        jsonStr =
            "{\r\n  \"sides\": {\r\n    \"0\": {\r\n      \"id\": 0,\r\n      \"fleets\": {\r\n        \"0\": {\r\n          \"ships\": {\r\n            \"0\": {\r\n              \"shipId\": 1,\r\n              \"name\": \"\u0422\u044F\u0436\u0435\u043B\u044B\u0439 \u0438\u0441\u0442\u0440\u0435\u0431\u0438\u0442\u0435\u043B\u044C\",\r\n              \"quantity\": 100,\r\n              \"armor\": \"100\",\r\n              \"baseDamage\": 10,\r\n              \"damage\": {\r\n                \"armor\": {\r\n                  \"lightArmor\": 1,\r\n                  \"mediumArmor\": 1,\r\n                  \"heavyArmor\": 0.5,\r\n                  \"reinforcedArmor\": 0.3\r\n                },\r\n                \"hull\": {\r\n                  \"small\": 1,\r\n                  \"medium\": 1,\r\n                  \"large\": 0.5,\r\n                  \"huge\": 0.3\r\n                }\r\n              },\r\n              \"armorType\": \"light\",\r\n              \"hullSize\": \"small\"\r\n            },\r\n            \"1\": {\r\n              \"shipId\": 12,\r\n              \"name\": \"\u041C\u0430\u043B\u044B\u0439 \u0442\u0440\u0430\u043D\u0441\u043F\u043E\u0440\u0442\",\r\n              \"quantity\": 100,\r\n              \"armor\": \"10\",\r\n              \"baseDamage\": 1,\r\n              \"damage\": {\r\n                \"armor\": {\r\n                  \"lightArmor\": 1,\r\n                  \"mediumArmor\": 1,\r\n                  \"heavyArmor\": 0.5,\r\n                  \"reinforcedArmor\": 0.3\r\n                },\r\n                \"hull\": {\r\n                  \"small\": 1,\r\n                  \"medium\": 1,\r\n                  \"large\": 0.5,\r\n                  \"huge\": 0.3\r\n                }\r\n              },\r\n              \"armorType\": \"light\",\r\n              \"hullSize\": \"small\"\r\n            }\r\n          },\r\n          \"is_garrison\": null,\r\n          \"name\": \"enemy fleet name 1\",\r\n          \"belongsTo\": 2,\r\n          \"captain\": null,\r\n          \"metal\": 5000,\r\n          \"crystal\": 3200,\r\n          \"gas\": 12232\r\n        },\r\n        \"1\": {\r\n          \"ships\": {\r\n            \"0\": {\r\n              \"shipId\": 12,\r\n              \"name\": \"\u041C\u0430\u043B\u044B\u0439 \u0442\u0440\u0430\u043D\u0441\u043F\u043E\u0440\u0442\",\r\n              \"quantity\": 50,\r\n              \"armor\": \"10\",\r\n              \"baseDamage\": 1,\r\n              \"damage\": {\r\n                \"armor\": {\r\n                  \"lightArmor\": 1,\r\n                  \"mediumArmor\": 1,\r\n                  \"heavyArmor\": 0.5,\r\n                  \"reinforcedArmor\": 0.3\r\n                },\r\n                \"hull\": {\r\n                  \"small\": 1,\r\n                  \"medium\": 1,\r\n                  \"large\": 0.5,\r\n                  \"huge\": 0.3\r\n                }\r\n              },\r\n              \"armorType\": \"light\",\r\n              \"hullSize\": \"small\"\r\n            },\r\n            \"2\": {\r\n              \"shipId\": 13,\r\n              \"name\": \"\u0411\u043E\u043B\u044C\u0448\u043E\u0439 \u0442\u0440\u0430\u043D\u0441\u043F\u043E\u0440\u0442\",\r\n              \"quantity\": 10,\r\n              \"armor\": \"100\",\r\n              \"baseDamage\": 10,\r\n              \"damage\": {\r\n                \"armor\": {\r\n                  \"lightArmor\": 1,\r\n                  \"mediumArmor\": 1,\r\n                  \"heavyArmor\": 0.5,\r\n                  \"reinforcedArmor\": 0.3\r\n                },\r\n                \"hull\": {\r\n                  \"small\": 1,\r\n                  \"medium\": 1,\r\n                  \"large\": 0.5,\r\n                  \"huge\": 0.3\r\n                }\r\n              },\r\n              \"armorType\": \"medium\",\r\n              \"hullSize\": \"large\"\r\n            },\r\n            \"3\": {\r\n              \"shipId\": 14,\r\n              \"name\": \"\u041F\u0435\u0440\u0435\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A\",\r\n              \"quantity\": 100,\r\n              \"armor\": \"10\",\r\n              \"baseDamage\": 1,\r\n              \"damage\": {\r\n                \"armor\": {\r\n                  \"lightArmor\": 1,\r\n                  \"mediumArmor\": 1,\r\n                  \"heavyArmor\": 0.5,\r\n                  \"reinforcedArmor\": 0.3\r\n                },\r\n                \"hull\": {\r\n                  \"small\": 1,\r\n                  \"medium\": 1,\r\n                  \"large\": 0.5,\r\n                  \"huge\": 0.3\r\n                }\r\n              },\r\n              \"armorType\": \"light\",\r\n              \"hullSize\": \"small\"\r\n            }\r\n          },\r\n          \"is_garrison\": null,\r\n          \"name\": null,\r\n          \"belongsTo\": 3,\r\n          \"captain\": null,\r\n          \"metal\": 0,\r\n          \"crystal\": 0,\r\n          \"gas\": 30000\r\n        }\r\n      }\r\n    },\r\n    \"1\": {\r\n      \"id\": 1,\r\n      \"fleets\": {\r\n        \"0\": {\r\n          \"ships\": {\r\n            \"0\": {\r\n              \"shipId\": 1,\r\n              \"name\": \"\u0422\u044F\u0436\u0435\u043B\u044B\u0439 \u0438\u0441\u0442\u0440\u0435\u0431\u0438\u0442\u0435\u043B\u044C\",\r\n              \"quantity\": 50,\r\n              \"armor\": \"100\",\r\n              \"baseDamage\": 10,\r\n              \"damage\": {\r\n                \"armor\": {\r\n                  \"lightArmor\": 1,\r\n                  \"mediumArmor\": 1,\r\n                  \"heavyArmor\": 0.5,\r\n                  \"reinforcedArmor\": 0.3\r\n                },\r\n                \"hull\": {\r\n                  \"small\": 1,\r\n                  \"medium\": 1,\r\n                  \"large\": 0.5,\r\n                  \"huge\": 0.3\r\n                }\r\n              },\r\n              \"armorType\": \"light\",\r\n              \"hullSize\": \"small\"\r\n            }\r\n          },\r\n          \"is_garrison\": null,\r\n          \"name\": \"neutral fleet name\",\r\n          \"belongsTo\": 10,\r\n          \"captain\": null,\r\n          \"metal\": 0,\r\n          \"crystal\": 0,\r\n          \"gas\": 3000\r\n        },\r\n        \"1\": {\r\n          \"ships\": {\r\n            \"0\": {\r\n              \"shipId\": 1,\r\n              \"name\": \"\u0422\u044F\u0436\u0435\u043B\u044B\u0439 \u0438\u0441\u0442\u0440\u0435\u0431\u0438\u0442\u0435\u043B\u044C\",\r\n              \"quantity\": 10,\r\n              \"armor\": \"100\",\r\n              \"baseDamage\": 10,\r\n              \"damage\": {\r\n                \"armor\": {\r\n                  \"lightArmor\": 1,\r\n                  \"mediumArmor\": 1,\r\n                  \"heavyArmor\": 0.5,\r\n                  \"reinforcedArmor\": 0.3\r\n                },\r\n                \"hull\": {\r\n                  \"small\": 1,\r\n                  \"medium\": 1,\r\n                  \"large\": 0.5,\r\n                  \"huge\": 0.3\r\n                }\r\n              },\r\n              \"armorType\": \"light\",\r\n              \"hullSize\": \"small\"\r\n            }\r\n          },\r\n          \"is_garrison\": null,\r\n          \"name\": null,\r\n          \"belongsTo\": 15,\r\n          \"captain\": null,\r\n          \"metal\": 0,\r\n          \"crystal\": 0,\r\n          \"gas\": 300\r\n        },\r\n        \"2\": {\r\n          \"ships\": {\r\n            \"0\": {\r\n              \"shipId\": 1,\r\n              \"name\": \"\u0422\u044F\u0436\u0435\u043B\u044B\u0439 \u0438\u0441\u0442\u0440\u0435\u0431\u0438\u0442\u0435\u043B\u044C\",\r\n              \"quantity\": 10,\r\n              \"armor\": \"100\",\r\n              \"baseDamage\": 10,\r\n              \"damage\": {\r\n                \"armor\": {\r\n                  \"lightArmor\": 1,\r\n                  \"mediumArmor\": 1,\r\n                  \"heavyArmor\": 0.5,\r\n                  \"reinforcedArmor\": 0.3\r\n                },\r\n                \"hull\": {\r\n                  \"small\": 1,\r\n                  \"medium\": 1,\r\n                  \"large\": 0.5,\r\n                  \"huge\": 0.3\r\n                }\r\n              },\r\n              \"armorType\": \"light\",\r\n              \"hullSize\": \"small\"\r\n            }\r\n          },\r\n          \"is_garrison\": null,\r\n          \"name\": null,\r\n          \"belongsTo\": 15,\r\n          \"captain\": null,\r\n          \"metal\": 0,\r\n          \"crystal\": 0,\r\n          \"gas\": 300\r\n        }\r\n      }\r\n    },\r\n    \"2\": {\r\n      \"id\": 2,\r\n      \"fleets\": {\r\n        \"0\": {\r\n          \"ships\": {\r\n            \"0\": {\r\n              \"shipId\": 1,\r\n              \"name\": \"\u0422\u044F\u0436\u0435\u043B\u044B\u0439 \u0438\u0441\u0442\u0440\u0435\u0431\u0438\u0442\u0435\u043B\u044C\",\r\n              \"quantity\": 56,\r\n              \"armor\": \"100\",\r\n              \"baseDamage\": 10,\r\n              \"damage\": {\r\n                \"armor\": {\r\n                  \"lightArmor\": 1,\r\n                  \"mediumArmor\": 1,\r\n                  \"heavyArmor\": 0.5,\r\n                  \"reinforcedArmor\": 0.3\r\n                },\r\n                \"hull\": {\r\n                  \"small\": 1,\r\n                  \"medium\": 1,\r\n                  \"large\": 0.5,\r\n                  \"huge\": 0.3\r\n                }\r\n              },\r\n              \"armorType\": \"light\",\r\n              \"hullSize\": \"small\"\r\n            },\r\n            \"1\": {\r\n              \"shipId\": 12,\r\n              \"name\": \"\u041C\u0430\u043B\u044B\u0439 \u0442\u0440\u0430\u043D\u0441\u043F\u043E\u0440\u0442\",\r\n              \"quantity\": 1,\r\n              \"armor\": \"10\",\r\n              \"baseDamage\": 1,\r\n              \"damage\": {\r\n                \"armor\": {\r\n                  \"lightArmor\": 1,\r\n                  \"mediumArmor\": 1,\r\n                  \"heavyArmor\": 0.5,\r\n                  \"reinforcedArmor\": 0.3\r\n                },\r\n                \"hull\": {\r\n                  \"small\": 1,\r\n                  \"medium\": 1,\r\n                  \"large\": 0.5,\r\n                  \"huge\": 0.3\r\n                }\r\n              },\r\n              \"armorType\": \"light\",\r\n              \"hullSize\": \"small\"\r\n            },\r\n            \"2\": {\r\n              \"shipId\": 14,\r\n              \"name\": \"\u041F\u0435\u0440\u0435\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A\",\r\n              \"quantity\": 1,\r\n              \"armor\": \"10\",\r\n              \"baseDamage\": 1,\r\n              \"damage\": {\r\n                \"armor\": {\r\n                  \"lightArmor\": 1,\r\n                  \"mediumArmor\": 1,\r\n                  \"heavyArmor\": 0.5,\r\n                  \"reinforcedArmor\": 0.3\r\n                },\r\n                \"hull\": {\r\n                  \"small\": 1,\r\n                  \"medium\": 1,\r\n                  \"large\": 0.5,\r\n                  \"huge\": 0.3\r\n                }\r\n              },\r\n              \"armorType\": \"light\",\r\n              \"hullSize\": \"small\"\r\n            }\r\n          },\r\n          \"is_garrison\": null,\r\n          \"name\": \"my fleet 2\",\r\n          \"belongsTo\": 1,\r\n          \"captain\": null,\r\n          \"metal\": 10000,\r\n          \"crystal\": 20000,\r\n          \"gas\": 31231\r\n        },\r\n        \"1\": {\r\n          \"ships\": {\r\n            \"0\": {\r\n              \"shipId\": 12,\r\n              \"name\": \"\u041C\u0430\u043B\u044B\u0439 \u0442\u0440\u0430\u043D\u0441\u043F\u043E\u0440\u0442\",\r\n              \"quantity\": 1,\r\n              \"armor\": \"10\",\r\n              \"baseDamage\": 1,\r\n              \"damage\": {\r\n                \"armor\": {\r\n                  \"lightArmor\": 1,\r\n                  \"mediumArmor\": 1,\r\n                  \"heavyArmor\": 0.5,\r\n                  \"reinforcedArmor\": 0.3\r\n                },\r\n                \"hull\": {\r\n                  \"small\": 1,\r\n                  \"medium\": 1,\r\n                  \"large\": 0.5,\r\n                  \"huge\": 0.3\r\n                }\r\n              },\r\n              \"armorType\": \"light\",\r\n              \"hullSize\": \"small\"\r\n            },\r\n            \"1\": {\r\n              \"shipId\": 13,\r\n              \"name\": \"\u0411\u043E\u043B\u044C\u0448\u043E\u0439 \u0442\u0440\u0430\u043D\u0441\u043F\u043E\u0440\u0442\",\r\n              \"quantity\": 1,\r\n              \"armor\": \"100\",\r\n              \"baseDamage\": 10,\r\n              \"damage\": {\r\n                \"armor\": {\r\n                  \"lightArmor\": 1,\r\n                  \"mediumArmor\": 1,\r\n                  \"heavyArmor\": 0.5,\r\n                  \"reinforcedArmor\": 0.3\r\n                },\r\n                \"hull\": {\r\n                  \"small\": 1,\r\n                  \"medium\": 1,\r\n                  \"large\": 0.5,\r\n                  \"huge\": 0.3\r\n                }\r\n              },\r\n              \"armorType\": \"medium\",\r\n              \"hullSize\": \"large\"\r\n            },\r\n            \"is_garrison\": null,\r\n            \"name\": \"my test fleet\",\r\n            \"belongsTo\": 1,\r\n            \"captain\": null,\r\n            \"metal\": 5000,\r\n            \"crystal\": 0,\r\n            \"gas\": 3232\r\n          },\r\n          \"is_garrison\": null,\r\n          \"name\": null,\r\n          \"belongsTo\": 1,\r\n          \"captain\": null,\r\n          \"metal\": 10000,\r\n          \"crystal\": 20000,\r\n          \"gas\": 31231\r\n        }\r\n      }\r\n    }\r\n  }\r\n}";
        var fleet = JSON.Parse(jsonStr);

        foreach (JSONNode BattleSide in fleet["sides"])
        {
            //сторона
            GameObject sideObject = _side.Create(BattleSide);

            foreach (JSONNode BattleFleet in BattleSide["fleets"])
            {
                var _fleet = sideObject.AddComponent<Fleet>();
                //флот внутри стороны
                GameObject fleetObject = _fleet.Create(sideObject, BattleFleet);

                foreach (JSONNode ship in BattleFleet["ships"])
                {
                    //Debug.Log("id : " + ship["shipId"] + "name : " + ship["name"]);
                    
                    //корабли внутри флота
                    var _spaceShip = fleetObject.AddComponent<SpaceShip>();
                    //GameObject shipObject = ShipsController.Create(fleetObject, ship);
                }
            }
        }
    }
}